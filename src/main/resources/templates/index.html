<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Homepage</title>


    <style>
        /* Set the size of the div element that contains the map */
        #map {
            height: 400px; /* The height is 400 pixels */
            width: 100%; /* The width is the width of the web page */
        }
    </style>

    <script
            src="http://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>
</head>
<body>


<h1>ISS tracker</h1>


<div id="map"></div>


<script>


    // var obj = $.getJSON('http://localhost:8080/position', function (data) {
    //
    // });


    var getJSON = function (url, callback) {
        var xhr = new XMLHttpRequest();
        xhr.open('GET', url, true);
        xhr.responseType = 'json';
        xhr.onload = function () {
            var status = xhr.status;
            if (status === 200) {
                callback(null, xhr.response);
            } else {
                callback(status, xhr.response);
            }
        };
        xhr.send();
    };




    function initMap() {


        var tid = setInterval(mycode, 2000);
        function mycode() {

            getJSON('http://localhost:8080/position',
                function (err, data) {
                    if (err !== null) {
                        console.log('Something went wrong: ' + err);
                    } else {
                        console.log('position delivered');
                        uluru = {lat: data.latitude, lng: data.longitude}


                        var map = new google.maps.Map(
                            document.getElementById('map'), {zoom: 3, center: uluru});
                        // The marker, positioned at Uluru
                        var marker = new google.maps.Marker({position: uluru, map: map});

                    }
                });

        }








    }
</script>

<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAKMSf74WjPCIZBva_RDKFJgs0RHzmUkj8&callback=initMap">
</script>

</body>
</html>